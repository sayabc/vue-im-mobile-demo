{"version":3,"sources":["webpack:///./src/pages/Session.vue","webpack:///./src/pages/Session.vue?a284","webpack:///./src/pages/Session.vue?480c"],"names":["pages_Session","data","delSessionId","stopBubble","noticeIcon","config","myPhoneIcon","myGroupIcon","defaultGroupIcon","myAdvancedIcon","defaultAdvancedIcon","computed","sysMsgUnread","temp","this","$store","state","addFriend","team","customSysMsgUnread","userInfos","myInfo","myPhoneId","userUID","sessionlist","_this","filter","item","name","avatar","scene","userInfo","to","util","getFriendAlias","teamInfo","teamlist","find","teamId","type","lastMsg","lastMsgShow","text","parseCustomMsg","generateTeamSysmMsg","mapMsgType","updateTime","updateTimeShow","formatDate","methods","enterSysMsgs","hideDelBtn","location","href","enterChat","session","id","enterMyChat","deleteSession","dispatch","showDelBtn","vNode","_this2","attrs","sessionId","setTimeout","selectortype_template_index_0_src_pages_Session","render","_vm","_h","$createElement","_c","_self","staticClass","title","nativeOn","click","$event","slot","width","src","_v","directives","rawName","value","expression","_s","_l","key","inline-desc","unread","class","active","on","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/7.35ec50d1ac14cbb099af.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport util from '../utils'\nimport config from '../configs'\n\nexport default {\n  data () {\n    return {\n      delSessionId: null,\n      stopBubble: false,\n      noticeIcon: config.noticeIcon,\n      myPhoneIcon: config.myPhoneIcon,\n      myGroupIcon: config.defaultGroupIcon,\n      myAdvancedIcon: config.defaultAdvancedIcon\n    }\n  },\n  computed: {\n    sysMsgUnread () {\n      let temp = this.$store.state.sysMsgUnread\n      let sysMsgUnread = temp.addFriend || 0\n      sysMsgUnread += temp.team || 0\n      let customSysMsgUnread = this.$store.state.customSysMsgUnread\n      return sysMsgUnread + customSysMsgUnread\n    },\n    userInfos () {\n      return this.$store.state.userInfos\n    },\n    myInfo () {\n      return this.$store.state.myInfo\n    },\n    myPhoneId () {\n      return `${this.$store.state.userUID}`\n    },\n    sessionlist () {\n      let sessionlist = this.$store.state.sessionlist.filter(item => {\n        item.name = ''\n        item.avatar = ''\n        if (item.scene === 'p2p') {\n          let userInfo = null\n          if (item.to !== this.myPhoneId) {\n            userInfo = this.userInfos[item.to]\n          } else {\n            // userInfo = this.myInfo\n            // userInfo.alias = '我的手机'\n            // userInfo.avatar = `${config.myPhoneIcon}`\n            return false\n          }\n          if (userInfo) {\n            item.name = util.getFriendAlias(userInfo)\n            item.avatar = userInfo.avatar\n          }\n        } else if (item.scene === 'team') {\n          let teamInfo = null\n          teamInfo = this.$store.state.teamlist.find(team => {\n            return team.teamId === item.to\n          })\n          if (teamInfo) {\n            item.name = teamInfo.name\n            item.avatar = teamInfo.avatar || (teamInfo.type === 'normal' ? this.myGroupIcon : this.myAdvancedIcon)\n          } else {\n            item.name = `群${item.to}`\n            item.avatar = item.avatar || this.myGroupIcon\n          }\n        }\n        let lastMsg = item.lastMsg || {}\n        if (lastMsg.type === 'text') {\n          item.lastMsgShow = lastMsg.text || ''\n        } else if (lastMsg.type === 'custom') {\n          item.lastMsgShow = util.parseCustomMsg(lastMsg)\n        } else if (lastMsg.scene === 'team' && lastMsg.type === 'notification') {\n          item.lastMsgShow = util.generateTeamSysmMsg(lastMsg)\n        } else if (util.mapMsgType(lastMsg)) {\n          item.lastMsgShow = `[${util.mapMsgType(lastMsg)}]`\n        } else {\n          item.lastMsgShow = ''\n        }\n        if (item.updateTime) {\n          item.updateTimeShow = util.formatDate(item.updateTime, true)\n        }\n        return item\n      })\n      return sessionlist\n    }\n  },\n  methods: {\n    enterSysMsgs () {\n      if (this.hideDelBtn())\n        return\n      location.href = '#/sysmsgs'\n    },\n    enterChat (session) {\n      if (this.hideDelBtn())\n        return\n      if (session && session.id)\n        location.href = `#/chat/${session.id}`\n    },\n    enterMyChat () {\n      // 我的手机页面\n      location.href = `#/chat/p2p-${this.myPhoneId}`\n    },\n    deleteSession () {\n      if (this.delSessionId !== null) {\n        this.$store.dispatch('deleteSession', this.delSessionId)\n      }\n    },\n    showDelBtn (vNode) {\n      if (vNode && vNode.data && vNode.data.attrs) {\n        this.delSessionId = vNode.data.attrs.sessionId\n        this.stopBubble = true\n        setTimeout(() => {\n          this.stopBubble = false\n        }, 20)\n      }\n    },\n    hideDelBtn () {\n      if (this.delSessionId !== null && !this.stopBubble) {\n        // 用于判断是否前置状态是显示删除按钮\n        this.delSessionId = null\n        return true\n      }\n      return false\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/Session.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"g-inherit m-main p-session\"},[_c('group',{staticClass:\"u-list\"},[_c('cell',{staticClass:\"u-list-item\",attrs:{\"title\":\"消息中心\"},nativeOn:{\"click\":function($event){return _vm.enterSysMsgs($event)}}},[_c('img',{staticClass:\"icon\",attrs:{\"slot\":\"icon\",\"width\":\"24\",\"src\":_vm.noticeIcon},slot:\"icon\"}),_vm._v(\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.sysMsgUnread > 0),expression:\"sysMsgUnread > 0\"}],staticClass:\"u-unread\"},[_vm._v(_vm._s(_vm.sysMsgUnread))])]),_vm._v(\" \"),_c('cell',{staticClass:\"u-list-item\",attrs:{\"title\":\"我的手机\"},nativeOn:{\"click\":function($event){return _vm.enterMyChat($event)}}},[_c('img',{staticClass:\"icon\",attrs:{\"slot\":\"icon\",\"width\":\"24\",\"src\":_vm.myPhoneIcon},slot:\"icon\"})]),_vm._v(\" \"),_vm._l((_vm.sessionlist),function(session){return _c('cell',{key:session.id,staticClass:\"u-list-item\",attrs:{\"title\":session.name,\"inline-desc\":session.lastMsgShow,\"sessionId\":session.id},nativeOn:{\"click\":function($event){_vm.enterChat(session)}}},[_c('img',{staticClass:\"icon u-circle\",attrs:{\"slot\":\"icon\",\"width\":\"24\",\"src\":session.avatar},slot:\"icon\"}),_vm._v(\" \"),_c('span',{staticClass:\"u-session-time\"},[_vm._v(\"\\n        \"+_vm._s(session.updateTimeShow)+\"\\n      \")]),_vm._v(\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(session.unread > 0),expression:\"session.unread > 0\"}],staticClass:\"u-unread\"},[_vm._v(_vm._s(session.unread))]),_vm._v(\" \"),_c('span',{staticClass:\"u-tag-del\",class:{active: _vm.delSessionId===session.id},on:{\"click\":_vm.deleteSession}})])})],2)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7884f248\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/Session.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7884f248\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vux-loader/src/style-loader.js!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Session.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Session.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vux-loader/src/script-loader.js!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Session.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7884f248\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../node_modules/vux-loader/src/template-loader.js!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Session.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/Session.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}